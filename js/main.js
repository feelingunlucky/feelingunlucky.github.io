var currentSearch="",shouldRefresh=!1,lastOptionSelected=0,firstSearch=!0,upsideDown=!1,lastRandom=-1,options=["Googling...","Exploring...","Searching...","Diving...","Navigating...","Looking...","Investigating...","Browsing..."];function removeParameter(e,t){var n=e.split("?");if(2<=n.length){for(var r=n.shift(),a=n.join("?"),o=encodeURIComponent(t)+"=",i=a.split(/[&;]/g),s=i.length;0<s--;)-1!==i[s].lastIndexOf(o,0)&&i.splice(s,1);e=r+"?"+i.join("&")}return e}function clearResults(){$("#results").children(":not(#state):not(.spinner)").remove()}function getRandomColor(){var e=16777215*Math.random()|0;return"rgb("+Math.max(e>>16&255,170)+","+Math.max(e>>8&255,170)+","+Math.max(255&e,170)+")"}function setStatusText(t){$("#state").animate({opacity:0},{duration:150,easing:"linear",queue:!1,complete:function(){var e=$(this);e.contents().filter(function(){return 3==this.nodeType}).first().replaceWith(t),e.animate({opacity:1},{duration:100,easing:"linear",queue:!1})}})}function setRandomSearchText(){for(var e;(e=Math.random()*options.length|0)==lastOptionSelected;);setStatusText(options[lastOptionSelected=e])}function onSearchStarted(){$("#state").animate({color:""==currentSearch?"#BBBBFFFF":getRandomColor(),queue:!1,duration:1e3,easing:"linear",complete:function(){""!=currentSearch&&(setRandomSearchText(),onSearchStarted())}}),$(".spinner").animate({opacity:1,easing:"linear"},500);var e=$("#results");e.is(":visible")||e.is(":animated")||e.slideDown("fast").css("display","inline-block")}function onSearchEnded(){$("#state").animate({color:"#BBBBFF",queue:!1,easing:"linear",duration:900}),$(".spinner").animate({opacity:0,easing:"linear"},90);var e=$("#results");""==getQuery(!0)?e.fadeOut("fast"):e.is(":visible")||e.is(":animated")||e.slideDown("fast").css("display","inline-block"),currentSearch=""}function parseResultsFromGoogle(e){var t=$("#results");t.hide(),clearResults();var n=document.getElementsByClassName("gsc-result");if(0<n.length){setStatusText("Page "+e+" (results may vary)");var r=document.createElement("div"),a=n[n.length-1];r.innerHTML=a.innerHTML,t.append(r);var o=$(r);o.find("*").each(function(){$(this).attr("data-cturl",this.href),$(this).attr("data-ctorig",this.href),$(this).attr("onload","")}),o.find(".gs-title").each(function(){$(this).removeClass("gs-title"),$(this).before("<br/>"),$(this).after("<br/>")}),o.find("img").each(function(){$(this).before("<br/>"),$(this).after("<br/>")}),o.find(".gsc-url-bottom").each(function(){var e=$(this).find(">:first-child");null!==e&&e.remove(),$(this).before("<p/>"),$(this).after("<p/>")}),o.find(".gsc-url-top").each(function(){var e=$(this).find(">:first-child");null!==e&&e.remove()}),o.find(".gs-visibleUrl").each(function(){$(this).removeClass()}),o.find(".gsc-thumbnail-inside").each(function(){$(this).remove()}),o.find(".gsc-url-top").each(function(){$(this).remove()}),o.find(".gs-snippet").each(function(){$(this).replaceWith(function(){return $("<span/>",{html:this.innerHTML})})})}else shouldRefresh=!0,setStatusText("No results were found")}function parseResults(e,t,n){var r=$("#results");if(r.hide(),clearResults(),null===e)shouldRefresh=!0,setStatusText("No results were found");else{setStatusText("Page "+(10*n+(t/10|0)+1)+" (results may vary)");for(var a=Array.from(e.getElementsByTagName("a")),o=0;o<a.length;o++){var i=a[o].getAttribute("href");i.startsWith("/url?q=")?(i=removeParameter(i=removeParameter(i=removeParameter(i,"sa"),"ved"),"usg"),a[o].href=unescape(i.substring(7)),a[o].target="_blank",a[o].rel="noopener noreferrer"):(a[o].parentNode.removeChild(a[o]),a.splice(o,1),o--)}if(0<a.length){var s=e.innerHTML,c=document.createElement("div");c.innerHTML=s,r.append(c)}for(var l=$("#_nBb"),u=0;u<l.length;u++)l[u].parentNode.removeChild(l[u])}}function getParameterByName(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function getQuery(e){var t=getParameterByName("q");return null==t?e?document.getElementById("query").value.trim():"":t}function runQuery(e){getQuery(!0);var r=0,a=0,o=setInterval(function(){function e(){r<24?r++:(clearInterval(o),shouldRefresh=!0,a=0,clearResults(),setStatusText("An error occurred while trying to connect to google.com"),onSearchEnded(),r=0)}var t=document.getElementsByClassName("gsc-cursor-page");if(0<t.length){var n=document.getElementsByClassName("gsc-cursor-current-page");0===n.length||n[0]!==t[t.length-1]?(a%8==0?t[t.length-1].click():e(),a++):(clearInterval(o),a=0,setTimeout(function(){parseResultsFromGoogle(document.getElementsByClassName("gsc-cursor-current-page")[0].innerText.trim()),onSearchEnded()},2e3),r=0)}else 0<document.getElementsByClassName("gsc-result").length?(clearInterval(o),a=0,setTimeout(function(){parseResultsFromGoogle(1),onSearchEnded()},2e3),r=0):e()},1e3)}function startGoogleSearch(){if(google.search.cse.element.getAllElements().standard0.execute(getQuery(!0)),firstSearch){firstSearch=!1;for(var e=0;e<document.styleSheets.length;e++){document.styleSheets[e].href.endsWith("homepage.css")||(document.styleSheets[e].disabled=!0)}}}function startQuery(e,t){var n=document.getElementById("query").value.trim();if(""===n||currentSearch!=n)if(t=void 0!==t&&""!=t?"&"+t:"",0===(currentSearch=n).length)e&&!window.location.protocol.startsWith("file")&&window.history.pushState(n,"Feeling Unlucky",window.location.origin+t),onSearchEnded();else{if(e&&!window.location.protocol.startsWith("file")&&n===getQuery(!1))return void onSearchEnded();window.location.protocol.startsWith("file")||(shouldRefresh?(shouldRefresh=!1,window.location.href=window.location.origin+"/?q="+escape(n)+t):e&&window.history.pushState(n,"Feeling Unlucky - "+n,window.location.origin+"/?q="+escape(n)+t)),clearResults(),setRandomSearchText(),onSearchStarted(),runQuery(8),e&&throwConfetti(40,200);try{startGoogleSearch()}catch(e){var r=0,a=setInterval(function(){try{clearInterval(a),startGoogleSearch(),r=0}catch(e){10<++r&&(clearInterval(a),r=0)}},1e3)}}}function runQueryFromUrl(){var e=getQuery(!1);""===e?(document.getElementById("query").value="",clearResults(),onSearchEnded()):(document.getElementById("query").value=unescape(e),startQuery(!1))}function cursorFocus(e){var t=window.scrollX,n=window.scrollY;e.focus(),window.scrollTo(t,n)}function changeBackground(){var e=$(".triangles"),t=$(background());t.css("opacity",0),t.animate({opacity:1},400),e.fadeOut(600,function(){$(this).remove()})}function throwConfetti(e,t){confetti&&confetti.start&&confetti.start(1200,e,t)}function startRandomSearch(){for(var e;(e=9897*Math.random()|0)===lastRandom;);lastRandom=e,$.ajax({url:"/text/"+e,type:"GET"}).done(function(e,t){document.getElementById("query").value=e,startQuery(!0,"r=1")}).fail(function(e,t){document.getElementById("query").value="Random",startQuery(!0,"r=1")})}!function(){function u(e){return"function"==typeof e||"[object Function]"===t.call(e)}function h(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(0<t?1:-1)*(0|Math.abs(t)):t}(e);return Math.min(Math.max(t,0),n)}var t,n;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return t<this.length?t|=0:t=this.length,this.substr(t-e.length,e.length)===e}),Array.from||(Array.from=(t=Object.prototype.toString,n=Math.pow(2,53)-1,function(e,t,n){var r=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var a,o=1<arguments.length?t:void 0;if(void 0!==o){if(!u(o))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(a=n)}for(var i,s=h(r.length),c=u(this)?Object(new this(s)):new Array(s),l=0;l<s;)i=r[l],c[l]=o?void 0===a?o(i,l):o.call(a,i,l):i,l+=1;return c.length=s,c}))}(),$(document).ready(function(){$("h1").css("text-shadow","rgba(0,0,0,0.8) 0em 0em 0.1em"),$("#search").click(function(e){startQuery(!0),e.preventDefault()}),$(".confetti-click").click(function(e){throwConfetti(10,50),e.preventDefault()}),$(".change").click(function(e){changeBackground(),e.preventDefault()}),$("#query").keypress(function(e){13===e.keyCode&&($("#search").focus(),startQuery(!0),e.preventDefault())}),$(".suggestion").each(function(){$(this).attr("href","javascript:void(0)")}),$(".suggestion").click(function(e){var t=$(this).text().replace(",","").trim().toLowerCase();"random"==t.toLowerCase()?startRandomSearch():(document.getElementById("query").value=t,startQuery(!0)),e.preventDefault()}),window.onpopstate=function(e){runQueryFromUrl()},cursorFocus($("input")),$("#left-arrow").click(function(e){cursorFocus($("input"))}),$("#container").animate({opacity:1},100,"linear",function(){$("*").css("transition","100ms")}),runQueryFromUrl()});